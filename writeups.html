<!-- Existing HTML code -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CTF Write-ups Blog</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
        crossorigin="anonymous">

    <style>
        body {
            background-color: #000;
            color: #fff;
        }

        .navbar {
            background-color: #000;
        }

        .btn-danger {
            background-color: #d9534f;
            border-color: #d43f3a;
        }

        .btn-danger:hover {
            background-color: #c9302c;
            border-color: #ac2925;
        }

        .card {
            background-color: #222;
            border: 1px solid #d9534f;
            color: #fff;
        }

        .card-header {
            background-color: #d9534f;
            border-bottom: 1px solid #d9534f;
            color: #fff;
        }

        .card-body {
            color: #fff;
        }

        .latest-writeup {
            width: 100%;
            max-width: 800px;
            margin: auto;
        }

        .home-button {
            background-color: #d9534f;
            border-color: #d43f3a;
            color: #fff;
        }

        .home-button:hover {
            background-color: #c9302c;
            border-color: #ac2925;
        }

        .code-container {
            background-color: #1e1e1e;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }

        .code {
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            margin: 0;
        }

        .img-fluid {
            max-width:fit-content;
            height:auto;
        }
    </style>
</head>

<body>

    <!-- Blog Content -->
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-8 mx-auto">
                <!-- Home Back Button -->
                <a href="index.html" class="btn btn-danger home-button mb-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                        class="bi bi-house-door" viewBox="0 0 16 16">
                        <path
                            d="M0 0v16h16V0H0zm12 7.154V14H4v-6.846l-.512-.513 7.143-7.142 7.142 7.142-.513.513z" />
                    </svg>
                    Home
                </a>

                <!-- Latest Write-up (Enhanced) -->
                <div class="card mb-4 latest-writeup">
                    <div class="card-header">
                        Web Exploitation
                    </div>
                    <div class="card-body">
                           <!-- Blog Post 1 (Enhanced) -->
                           <h5 class="card-title">More Cookies</h5>
                           <p class="card-text">I forgot Cookies can Be modified Client-side, so now I decided to encrypt them! </p>
                           <h4>#Hint</h4>
                           <p>
                               1 hint they given one wikipedia page which tells about homomorphic encryption.<br>
                               homomorphic encryption is a form of encryption that allows users to perform binary operations on encrypted data without ever decrypting the data.
                               </p>
                               <p>
                               2 hint they given is the search endpoint is only helpful for telling you if you are admin or not, you won't be able to guess the flag name.
                               </p>
                               <p>Ok let's focus on the hint one and keep homomorphic encryption  a side in your mind </p>
                               <img src="cookie.png" class="img-thumbnail" alt="...">
                               <p>Finally i understand that only admin can access the cookie.So now our goal is to find the admin</p>
                               <h4> But how ‚ùì‚ùì‚ùì</h4>
                               
                               <p>Ok cool!</p>
                               <p>Now find the cookie? ü•∑üèª</p>
                               
                               <img src="findcok.png" class="img-thumbnail" alt="..."><br><br><br>
                               <h4>Cookie I found </h4>
                               <p>"Z1JYcVRFdnR1T2VtVzJxdFpFZmVMaVdONWNmejRwTzhyM2RvNDZpY0VEbWZtdHZOOVdsb0JKMEdSaWdvcWZnZFAxMHJsdk9VMytWM0toSU5mVHdQaThzcG1TR3BFMlUxMTBJZWNxV2lYR2JUeHFhWWFtQ2RuQ2MrM3AzcUFIdEc="</p>
                               <h5>steps</h5>
                               <ul>
                                   <li>first thing we have to decode the given cookie because it is in the base64 format</li>
                                   <li>output decoded_text here </li>
                                     <p>b'gRXqTEvtuOemW2qtZEfeLiWN5cfz4pO8r3do46icEDmfmtvN9WloBJ0GRigoqfgdP10rlvOU3+V3KhINfTwPi8spmSGpE2U110IecqWiXGbTxqaYamCdnCc+3p3qAHtG'</p>
                                   <li>I am decoding it again because if I will get any clue ??</li>
                                   <li>output for second decoded_text </li>
                                      <p> b"\x81\x15\xeaLK\xed\xb8\xe7\xa6[j\xaddG\xde.%\x8d\xe5\xc7\xf3\xe2\x93\xbc\xafwh\xe3\xa8\x9c\x109\x9f\x9a\xdb\xcd\xf5ih\x04\x9d\x06F((\xa9\xf8\x1d?]+\x96\xf3\x94\xdf\xe5w*\x12\r}<\x0f\x8b\xcb)\x99!\xa9\x13e5\xd7B\x1er\xa5\xa2\\f\xd3\xc6\xa6\x98j`\x9d\x9c'>\xde\x9d\xea\x00{F"</p>
                                   <li>Again we are getting some garbage and gibberish data</li>
                                   <li>so it indicates that it is encrypted data.Here one important point is .In previous steps we only  decoded it from the base64 to normal form.</li>
                                     <li>But after that we are getting data in some other format so it is not in base64 form it is in some other form of  encryption .Finally data is encrypted.</li>
                                     <li>Now remind the <mark>homomorphic encryption </mark>topic.</li>
                                   <li>In the description of the ctf they highlighted C,B,C aphalbets.So it gives a clue like <mark>Cipher Block Chaining</mark> (BitFlip).</li>
   
                                   <li>It is the one of the Block Cipher Mode Of Operations .Cipher Block chaining is a block cipher mode of operation that enhances security by chaining each ciphertext block with the previous one before encryption.</li>
                                      <li>here it uses simple mechanisim like plain text is XOR with previous encrypted text or cipher text and after encryption atlast it produces the cipher text.</li>
                                      <li>So here one cipher text is important to produce another cipher text.</li>
                                       <li>By using CBC BitFlip we have to flip the bits in the cookie untill to become admin ,We don't know whether admin=0 or admin=1.</li>
                                       <p>So here we are uing Brute forcing technique.</p>
                                       <li>Here we are Brute forcing on the encrypted data .So <mark>homomorphic encryption </mark> comes into picture.</li>
                               </ul><br>
                               <h4 class="card-body">üöÄHere I written a python  code to perform CBC_BitFlip on the given encrypted data</h4>
                               <div class="code-container">
                               <code class="code">
   from base64 import b64decode , b64encode
   import requests
   
   def CBC_Flip(Byte_pos,in_bit,data):
       #bytearray function divide a byte in to sequence of the bits
       array1=bytearray(data) 
       #here we are performing xor operation on the each byte in the encrypted data with 
       index bit.
       array1[Byte_pos]=array1[Byte_pos] ^ (1 << in_bit)
       <div style="color:yellow;">
       #example with 129 xor with bit no 0 (left shifting for every bit from 0 to 7)
       #byte no 0
       #129, and shift 1 for the bit position 0
       #here byte of 0 is changing 128 by changing bit position ==>0
       #byte no 0
       #129, and shift 2 for the bit position 1
       #here byte of 0 is changing 131 by changing bit position ==>1
       #byte no 0
       #129, and shift 4 for the bit position 2
       #here byte of 0 is changing 133 by changing bit position ==>2
       #byte no 0
       #129, and shift 8 for the bit position 3
       #here byte of 0 is changing 137 by changing bit position ==>3
       #byte no 0
       #129, and shift 16 for the bit position 4
       #here byte of 0 is changing 145 by changing bit position ==>4
       #byte no 0
       #129, and shift 32 for the bit position 5
       #here byte of 0 is changing 161 by changing bit position ==>5
       #byte no 0
       #129, and shift 64 for the bit position 6
       #here byte of 0 is changing 193 by changing bit position ==>6
       #byte no 0
       #129, and shift 128 for the bit position 7
       #here byte of 0 is changing 1 by changing bit position ==>7
       </div>
       #without left shifting we cannot shift the bit  one by one we have to traverse the 
       each and every bit in the byte.
       fliped_data=bytes(array1)#bytes function makes that array bits into single byte.
       #here we are encoding twice decause we are decoded it with twice and atlast 
       #we are decode the byte data into string.
       return b64encode(b64encode(fliped_data)).decode() 
                                   
                                   
   #we have iterate the each byte in the second_decode text
   for i in range(0,len(second_decode)):
       #In that byte we have to iterate each bit of the byte
       for j in range(0,8):
           admin=CBC_Flip(i,j,second_decode)
           cookie={
               "auth_name":admin
               }
           response=request.get("",cookie=cookie)
           if "picoCTF{" in response.text:
               print(response.text)
               print(f"we got that byte{i} and bit value {j}")
               break
                                  
                               </code>
                               </div>
                               <mark>If you clearly read the comments and code which i provided above will definetly understand the process.</mark><br><br>
                               <h4 class="card-body">Paper work ‚úçüèª I did for the BitFliping and XOR operation</h4>
                               <img src="bir.jpeg" class="img-thumbnail" alt="..."> <br><br>
                               <img src="Xor.jpeg" class="img-thumbnail" alt="...">
                               
                               <br><br>
   
                               <h4>Finally  I got the Flag!! üèÜüéâ </h4>
                               <img src="cokfi.png" class="img-thumbnail" alt="...">
                               
                               <mark>‚úÖ picoCTF{c00ki3s_yum_82f39377}</mark>
   

                        <hr>

                        <!-- Additional content for Read More -->

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>

</html>
